(this["webpackJsonpwtt-import"]=this["webpackJsonpwtt-import"]||[]).push([[0],{248:function(e,t,a){e.exports=a(487)},253:function(e,t,a){},487:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(4),l=a.n(c),i=(a(253),a(55)),u=a(16),o=a(35),s=a(209),m={tracks:[],csvLines:[],currentStep:0,currentLine:0},E=a(174),p=a(211),d={key:"root",storage:a.n(p).a},f=Object(E.a)(d,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TRACK":return Object(o.a)({},e,{tracks:[].concat(Object(u.a)(e.tracks),[t.track])});case"SET_CSV_LINES":return Object(o.a)({},e,{csvLines:t.lines});case"SET_CURRENT_LINE":return Object(o.a)({},e,{currentLine:t.lineIndex});case"SET_CURRENT_STEP":return Object(o.a)({},e,{currentStep:t.step});case"CANCEL_IMPORT":return{tracks:[],csvLines:[],currentStep:0,currentLine:0};case"DELETE_TRACK":var a=Object(s.remove)(e.tracks,(function(e){return e.id!==t.id}));return Object(o.a)({},e,{tracks:a});case"EDIT_TRACK":var n=Object(u.a)(e.tracks),r=n.findIndex((function(e){return e.id===t.track.id}));return r>-1?(n.splice(r,1,Object(o.a)({},t.track)),Object(o.a)({},e,{tracks:n})):(n.push(t.track),Object(o.a)({},e,{tracks:n}));default:return e}})),v=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.c,y=a(32),b=a(212),k=(a(176),a(103)),h=a(106),g=a(73),O=(a(177),a(135)),j=(a(490),a(242)),T=(a(46),a(8)),x=a(25),C=(a(266),a(175)),I=a(500),S=a(213),_=a.n(S),w=(a(178),a(75)),L=(a(180),a(57)),A=(a(181),a(27)),q=a(20),N=a.n(q),R=a(39),F=a(121),D=a.n(F),M=(a(275),a(243)),z=(a(147),a(80)),P=(a(182),a(44)),V=function(e){var t=e.track,a=e.visible,c=e.editTrack,l=e.closeModal,i=Object(n.useState)(!1),u=Object(x.a)(i,2),s=u[0],m=u[1],E=P.a.useForm(),p=Object(x.a)(E,1)[0];Object(n.useEffect)((function(){p.setFieldsValue({artist:t.artist,title:t.title,year:t.year})}),[p,t]);return r.a.createElement(M.a,{visible:a,onOk:function(){m(!0),p.validateFields().then((function(e){p.resetFields(),c(Object(o.a)({},t,{},e))})),m(!1),l()},onCancel:function(){l()},confirmLoading:s},r.a.createElement(P.a,{form:p,name:"edit-track"},r.a.createElement(P.a.Item,{name:"artist",label:"Artiste(s)",rules:[{required:!0}]},r.a.createElement(z.a,null)),r.a.createElement(P.a.Item,{name:"title",label:"Titre",rules:[{required:!0}]},r.a.createElement(z.a,null)),r.a.createElement(P.a.Item,{name:"year",label:"Ann\xe9e de sortie",rules:[{required:!0}]},r.a.createElement(z.a,null))))},U=null,K=function(){var e=Object(R.a)(N.a.mark((function e(){var t,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/spotifyToken");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,200!==t.status&&console.log("Error: ".concat(a.error_description)),U=a.access_token;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();K();var J=function(){var e=Object(R.a)(N.a.mark((function e(t){var a,n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U){e.next=3;break}return e.next=3,K();case 3:return"follow",a={method:"GET",headers:{Authorization:"Bearer ".concat(U)},redirect:"follow"},e.next=7,fetch("https://api.spotify.com/v1/search?q=".concat(t,"&type=track"),a);case 7:return n=e.sent,e.next=10,n.json();case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(R.a)(N.a.mark((function e(t){var a,n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.normalize("NFD").replace(/[\u0300-\u036f]/g,""),e.next=4,fetch("/deezerTrack?q=".concat(a));case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r);case 11:e.prev=11,e.t0=e.catch(0),console.log("error");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),G=a(493),H=function(e){return e.map((function(e){return e.name})).join(", ")},X=function(e){var t=e.release_date_precision,a=e.release_date;return"year"===t?parseInt(a,10):parseInt(a.substring(0,4),10)},W=(a(165),a(72)),Q=(a(206),a(104)),Y=a(499),Z=Q.a.Text,$=function(e){var t=e.track,a=e.play,n=e.selectTrack,c=t.preview_url,l=t.name,i=t.artists,u=t.album,o=H(i),s=X(u);return r.a.createElement(w.a.Item,{actions:c?[r.a.createElement(T.a,{icon:r.a.createElement(Y.a,null),onClick:function(){return a(c)}}),r.a.createElement(T.a,{onClick:function(){return n(t)}},"S\xe9lectionner")]:[]},r.a.createElement(w.a.Item.Meta,{avatar:r.a.createElement(W.a,{shape:"square",src:u.images[0].url}),title:l,description:o}),r.a.createElement(Z,{type:"secondary"},s||"?"))},ee=function(e){var t=e.track,a=e.play,n=e.selectTrack,c=t.preview,l=t.artist,i=t.title,u=t.album;return r.a.createElement(w.a.Item,{actions:c?[r.a.createElement(T.a,{icon:r.a.createElement(Y.a,null),onClick:function(){return a(c)}}),r.a.createElement(T.a,{onClick:function(){return n(t)}},"S\xe9lectionner")]:[]},r.a.createElement(w.a.Item.Meta,{avatar:r.a.createElement(W.a,{shape:"square",src:u.cover}),title:i,description:l.name}),r.a.createElement(Z,{type:"secondary"},u.release_date||"?"))},te=function(e){return{type:"SET_CURRENT_LINE",lineIndex:e}},ae=function(e){return{type:"SET_CURRENT_STEP",step:e}},ne=function(e){return{type:"EDIT_TRACK",track:e}},re=(a(489),a(173)),ce=(a(207),a(93)),le=function(e){var t=e.selectedTrack,a=e.handleEdit,n=e.goToNextLine,c=Object(y.b)();return t?r.a.createElement(re.a,{title:"Morceau s\xe9lectionn\xe9",extra:r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{onClick:function(){return a(t)}},"Modifier"),r.a.createElement(T.a,{type:"primary",onClick:function(){var e;(e=t).title?e.artist?e.year?(c({type:"ADD_TRACK",track:e}),n()):ce.a.error("Ann\xe9e de sortie manquante"):ce.a.error("Artiste manquant"):ce.a.error("Titre manquant")}},"Ajouter \xe0 la playlist"))},r.a.createElement(W.a,{shape:"square",size:"large",src:t.coverImage}),"Titre : ",t.title,"Artiste(s) : ",t.artist,"' Ann\xe9e de sortie :"," ",t.year||"?"):r.a.createElement(re.a,{title:"S\xe9lectionner un morceau"},r.a.createElement(W.a,{shape:"square",size:"large"},"?"))},ie=function(e){var t=e.index,a=e.isLastLine,c=e.endIntegration,l=e.lineAmount,i=Object(y.c)((function(e){return e.csvLines[t]})),u=Object(y.b)(),o=Object(n.useState)([]),s=Object(x.a)(o,2),m=s[0],E=s[1],p=Object(n.useState)([]),d=Object(x.a)(p,2),f=d[0],v=d[1],b=Object(n.useState)(),k=Object(x.a)(b,2),h=k[0],g=k[1],j=Object(n.useState)(),C=Object(x.a)(j,2),I=C[0],S=C[1],_=Object(n.useState)(!1),q=Object(x.a)(_,2),F=q[0],M=q[1];Object(n.useEffect)((function(){S(void 0),E([]),v([]),function(){var e=Object(R.a)(N.a.mark((function e(){var t,a,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.artist+" "+i.title,e.next=3,J(t);case 3:return a=e.sent,E(a.tracks.items),e.next=7,B(t);case 7:n=e.sent,v(n.data);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[i]);var z=function(e){var t=function(e){var t=e.preview_url,a=e.name,n=e.artists,r=e.external_ids,c=e.id,l=e.popularity,i=e.album;if(t)return{audio:t,title:a,artist:H(n),isrc:r.isrc,spotifyId:c,popularity:l,year:X(i),coverImage:i.images[0].url,provider:"spotify",id:Object(G.a)()}}(e);S(t)},P=function(e){var t=function(e){var t=e.title,a=e.id,n=e.preview,r=e.artist,c=e.isrc,l=e.release_date,i=e.album;return{audio:n,artist:r.name,deezerId:a.toString(),isrc:c,year:l?parseInt(l,10):void 0,title:t,coverImage:i.cover_small,provider:"deezer",id:Object(G.a)()}}(e);S(t)},U=function(){u(te(t+1))};return r.a.createElement(O.a,{direction:"vertical",size:"large"},r.a.createElement(D.a,{src:h||"",autoPlay:!0,controls:!0}),r.a.createElement(L.a,{gutter:24},r.a.createElement(A.a,{span:6},r.a.createElement(T.a,{onClick:function(){u(te(t-1))},disabled:t<1},"<- Pr\xe9c\xe9dent")),r.a.createElement(A.a,{span:12},r.a.createElement("h2",null,i.title," \u2014 ",i.artist),t+1,"/",l),r.a.createElement(A.a,{span:6},a?r.a.createElement(T.a,{onClick:c},"Terminer l'int\xe9gration"):r.a.createElement(T.a,{onClick:U},"-> Suivant"))),r.a.createElement(le,{selectedTrack:I,handleEdit:function(){M(!0)},goToNextLine:U}),r.a.createElement(L.a,{gutter:24},r.a.createElement(A.a,{span:12},r.a.createElement("h3",null,"Spotify Tracks"),r.a.createElement(w.a,{dataSource:m,renderItem:function(e){return r.a.createElement($,{track:e,play:g,selectTrack:z})}})),r.a.createElement(A.a,{span:12},r.a.createElement("h3",null,"Deezer Tracks"),r.a.createElement(w.a,{dataSource:f,renderItem:function(e){return r.a.createElement(ee,{track:e,play:g,selectTrack:P})}}))),I&&r.a.createElement(V,{track:I,visible:F,closeModal:function(){return M(!1)},editTrack:function(e){return S(e)}}))},ue=(a(491),a(247)),oe=(a(450),a(246)),se=(a(452),a(244)),me=(a(454),a(140)),Ee=(a(488),a(172)),pe=a(497),de=a(496),fe=a(495),ve=a(494),ye=Q.a.Text,be=Q.a.Title,ke=Ee.a.Column,he=function(){var e=Object(y.b)(),t=P.a.useForm(),a=Object(x.a)(t,1)[0],c=Object(y.c)((function(e){return e.tracks})),l=Object(n.useState)(""),i=Object(x.a)(l,2),u=i[0],s=i[1],m=Object(n.useState)(),E=Object(x.a)(m,2),p=E[0],d=E[1],f=function(e){return e.id===u},v=function(){var t=Object(R.a)(N.a.mark((function t(n){var r,c,l;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.validateFields();case 3:r=t.sent,c=Object(o.a)({},n,{},r),e(ne(c)),s(""),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),l=t.t0.errorFields.map((function(e){return e.errors[0]})),ce.a.error(l);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),b=function(){s("")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{src:p||"",autoPlay:!0,controls:!0}),r.a.createElement(T.a,{type:"primary",icon:r.a.createElement(pe.a,null),onClick:function(){e(ae(3))}},"Valider l'import"),r.a.createElement(P.a,{form:a,component:!1},r.a.createElement(Ee.a,{title:function(){return r.a.createElement(be,{level:4},c.length," morceaux s\xe9lectionn\xe9s")},dataSource:c},r.a.createElement(ke,{dataIndex:"coverImage",key:"cover",render:function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{shape:"square",src:e}),r.a.createElement(me.a,{type:"vertical"}),p!==t.audio?r.a.createElement(T.a,{shape:"circle",onClick:function(){d(t.audio)},icon:r.a.createElement(de.a,null)}):r.a.createElement(T.a,{shape:"circle",onClick:function(){d("")},icon:r.a.createElement(fe.a,null)}))}}),r.a.createElement(ke,{title:"Titre",dataIndex:"title",key:"title",render:function(e,t){return f(t)?r.a.createElement(P.a.Item,{noStyle:!0,name:"title",rules:[{required:!0,whitespace:!0,message:"Merci de renseigner un titre"}]},r.a.createElement(z.a,null)):r.a.createElement(ye,{ellipsis:!0},e)}}),r.a.createElement(ke,{title:"Artiste(s)",dataIndex:"artist",key:"artist",render:function(e,t){return f(t)?r.a.createElement(P.a.Item,{noStyle:!0,name:"artist",rules:[{required:!0,whitespace:!0,message:"Merci de renseigner un artiste"}]},r.a.createElement(z.a,null)):r.a.createElement(ye,{ellipsis:!0},e)}}),r.a.createElement(ke,{title:"Ann\xe9e",dataIndex:"year",key:"year",sorter:function(e,t){return e.year-t.year},render:function(e,t){return f(t)?r.a.createElement(P.a.Item,{noStyle:!0,name:"year",rules:[{required:!0,message:"Ann\xe9e manquante"}]},r.a.createElement(se.a,null)):r.a.createElement(ye,{ellipsis:!0},e)}}),r.a.createElement(ke,{title:"Source",dataIndex:"provider",key:"provider",render:function(e){return r.a.createElement(oe.a,{color:"spotify"===e?"green":"geekblue"},e.toUpperCase())}}),r.a.createElement(ke,{title:"Actions",dataIndex:"actions",render:function(t,n){return f(n)?r.a.createElement(r.a.Fragment,null," ",r.a.createElement(T.a,{onClick:b},"Annuler"),r.a.createElement(me.a,{type:"vertical"}),r.a.createElement(T.a,{icon:r.a.createElement(pe.a,null),type:"primary",onClick:function(){return v(n)}})):r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{onClick:function(){return function(e){s(e.id),a.setFieldsValue(Object(o.a)({title:"",artist:"",year:""},e))}(n)}},"Modifier"),r.a.createElement(me.a,{type:"vertical"}),r.a.createElement(ue.a,{title:"Supprimer le morceau ?",onConfirm:function(){return e({type:"DELETE_TRACK",id:n.id})},okText:"Oui",cancelText:"Annuler",okType:"danger"},r.a.createElement(T.a,{icon:r.a.createElement(ve.a,null)})))}}))))},ge=(a(470),a(245)),Oe=function(){return r.a.createElement(ge.a,{status:"success",title:"L'import est termin\xe9 !",subTitle:"Tu peux maintenant t\xe9l\xe9charger le fichier final au format de ton choix.",extra:[r.a.createElement(T.a,{key:"1",type:"primary",onClick:function(){}},"T\xe9l\xe9charger au format JSON"),r.a.createElement(T.a,{key:"2",onClick:function(){}},"T\xe9l\xe9charger au format CSV")]})},je=C.a.Step,Te=function(){var e=Object(y.b)(),t=Object(y.c)((function(e){return e.csvLines})),a=Object(y.c)((function(e){return e.currentLine})),c=Object(y.c)((function(e){return e.currentStep})),l=Object(n.useState)(!1),i=Object(x.a)(l,2),u=i[0],o=i[1];return r.a.createElement(O.a,{direction:"vertical",size:"large",style:{width:"100%"}},r.a.createElement(C.a,{current:c},r.a.createElement(je,{title:"Import CSV"}),r.a.createElement(je,{title:"Int\xe9gration des morceaux"}),r.a.createElement(je,{title:"Validation"}),r.a.createElement(je,{title:"Export"})),r.a.createElement(T.a,{onClick:function(){return e({type:"CANCEL_IMPORT"})}},"Annuler l'import"),r.a.createElement("div",null,0===c&&r.a.createElement("div",null,r.a.createElement("div",null,t.length<=0&&r.a.createElement(j.a.Dragger,{accept:".csv",beforeUpload:function(t){if("text/csv"!==t.type)return!1;var a={skipEnmptyLines:!0,fastMode:!0,before:function(){o(!0)},complete:function(t){if(3===t.data[0].length){var a=t.data.map((function(e){return{artist:e[1],title:e[2]}}));e({type:"SET_CSV_LINES",lines:a}),o(!1)}else console.log("not the right format!")}};return _.a.parse(t,a),!1},name:"file",multiple:!1,showUploadList:!1},r.a.createElement(I.a,null),r.a.createElement("p",null,"Glisser-d\xe9poser un fichier CSV pour commencer")),u&&"Loading...",t.length>0&&r.a.createElement(T.a,{type:"primary",onClick:function(){e(ae(1))}},"Commencer l'int\xe9gration"))),1===c&&r.a.createElement(ie,{lineAmount:t.length,index:a,isLastLine:a===t.length-1,endIntegration:function(){e(ae(2))}}),2===c&&r.a.createElement(he,null),3===c&&r.a.createElement(Oe,null)))},xe=function(){return r.a.createElement("div",null,"Playlists")},Ce=function(){return r.a.createElement("p",null,"Home :) :) :) ")},Ie=(a(484),a(49)),Se=a(498),_e=k.a.Header,we=function(){return r.a.createElement(_e,{style:{backgroundColor:"white",display:"flex",justifyContent:"space-between",alignItems:"center"}},r.a.createElement("strong",null,"[WTT import]"),r.a.createElement(Ie.a,{theme:"light",mode:"horizontal"},r.a.createElement(Ie.a.Item,{key:"1"},r.a.createElement(h.b,{to:"/import"},r.a.createElement(Se.a,null)," Nouvelle playlist")),r.a.createElement(Ie.a.Item,{key:"2"},r.a.createElement(h.b,{to:"/playlists"},"Playlists"))))},Le=k.a.Content,Ae=function(){return r.a.createElement(k.a,{style:{height:"100vh"}},r.a.createElement(h.a,null,r.a.createElement(we,null),r.a.createElement(Le,{style:{height:"100%"}},r.a.createElement("div",{style:{backgroundColor:"white",padding:"40px",margin:"40px"}},r.a.createElement(g.c,null,r.a.createElement(g.a,{path:"/",exact:!0,component:Ce}),r.a.createElement(g.a,{path:"/playlists",component:xe}),r.a.createElement(g.a,{path:"/import",component:Te}))))))},qe=function(){var e=Object(i.d)(f,v());return{store:e,persistor:Object(E.b)(e)}}(),Ne=qe.store,Re=qe.persistor,Fe=function(){return r.a.createElement(y.a,{store:Ne},r.a.createElement(b.a,{persistor:Re},r.a.createElement(Ae,null)))},De=document.getElementById("root");l.a.render(r.a.createElement(Fe,null),De)}},[[248,1,2]]]);
//# sourceMappingURL=main.2fbdea94.chunk.js.map